jQuery(document).ready(function(m){var l,r,c,t,n,d,p,i,e,s,v,u,a,o,h,f,g,b,C,w,y,k,x,T,H,S,j,I,q,D,L,z,P,W,_,B;return c=m("body"),v=m("main"),S=m(".section-titles"),l=m("#archive"),r=m(".archive-medias"),m("#lightbox"),s=m("#lightbox-media"),d=m("header.desktop"),m("header.mobile"),i=m("footer"),.8,200,500,30,k=function(){return m(".chapter-square").each(function(e,t){return setTimeout(function(){return m(t).addClass("show")},500*(e+1))})},j=function(e){var t,n,i,a,o;if(e.preventDefault(),e.stopPropagation(),n=m(this).data("id"),i=m(this).data("title"),o=this.href,t=d.find(".chapter-title"),history.pushState(null,null,o),a=v.position().top,m("html, body").animate({scrollTop:a},500),v.data("id")!==n)return v.addClass("loading").data("id",n).data("url",o),t.attr("href",o).find("h3").html(i),b(n),!1},b=function(e){return v.removeClass("loaded").addClass("loading"),m.ajax({url:ajax_obj.ajaxurl,type:"POST",dataType:"html",data:{action:"get_chapter",id:e},success:function(e){return v.html(e),v.removeClass("loading").addClass("loaded"),y()},error:function(e,t,n){return console.log(e,t,n)}})},y=function(){var t;return t=m(".blocks"),S.html(""),t.find(".section-title").each(function(e,t){var n,i,a;if(i=m(t).find(".section-title-text").text())return n=z(i),m(t).attr("id",n),a=m('<h5 class="section-title"></h5>').attr("data-slug",n).html('<a href="#'+n+'" class="section-anchor">'+i+"</a>"),S.append(a)}),t.find(".media-block").each(function(e,t){var n;if(m(t).is(".full-media-block")&&!(n=m(t).find(".block-body")).text())return n.remove()}),t.imagesLoaded().done(function(){var e;return(e=window.location.hash)&&H(e,!1),m(window).on("scroll",f),t.addClass("loaded"),f()}),t.find("video").each(function(e,t){var n,i;if(n=m(t).parent(),t.loop=!0,t.autoplay=!0,t.muted=!0,n.addClass("muted mutable"),n.append(m('<div class="btn mute"></div>')),void 0!==(i=t.play()))return i.then(function(){return m(t).on("timeupdate",function(){var e;return e=m(t=this).parent(".media"),t.paused?e.addClass("muted"):(this.muted=!1,e.removeClass("muted"),m(t).off("timeupdate"))})}).catch(function(e){return console.log(e)})})},w=function(){return r.masonry({itemSelector:".col",transitionDuration:0}),r.masonry("on","layoutComplete",function(){return r.addClass("masonry")}),r.find(".block-media").each(function(e,t){return m(t).find("img").length?m(t).find("img")[0].onload=function(){if(r.is(".masonry"))return r.masonry()}:m(t).find("video").length?(m(t).addClass("paused"),m(t).find("video").on("loadeddata",function(){if(r.is(".masonry"))return r.masonry()})):void 0})},q=function(e){var t;return e.preventDefault(),t=e.target.hash,history.pushState(null,null,t),H(t,!0)},H=function(e,t){var n,i,a,o;if(e=decodeURIComponent(e),(a=m(".section-title"+e)).length?(o=a.position().top,"none"!==d.css("display")&&(o-=d.innerHeight()+1),t?m("html, body").animate({scrollTop:o},500):m("html, body").scrollTop(o)):m("html, body").scrollTop(0),e.includes("#archive")){if(P(),n=parseInt(e.split("-")[1]),!Number.isInteger(n))return;if(i=m(r.find(".archive-media")[n-1]))return C(i)}},x=function(){return m(".block-media.slideshow").each(function(e,a){var o;return o=0,(a=m(a)).imagesLoaded().progress(function(e,t){var n,i;if(n=t.img,i=m(n).parent(),n.naturalHeight>o)return o=n.naturalHeight,a.find(".static").removeClass("static"),a.attr("data-ratio",n.naturalHeight/n.naturalWidth),i.addClass("static")}).done(function(e){return m(window).resize()}),setInterval(function(){var e;return a.find(".active").length&&(e=a.find(".active").next(".media")),e&&e.length||(e=a.find(".media").first()),a.find(".active").removeClass("active"),e.addClass("active")},5e3)})},P=function(e){return c.is(".open-archive")?(t(),e.preventDefault()):g()},g=function(){return u(),S.find(".active").removeClass("active"),c.addClass("open-archive no-scroll"),r.masonry()},t=function(){var e;return c.removeClass("open-archive no-scroll"),e=window.location.href.split("#")[0],history.pushState(null,null,e),m(window).scroll()},I=function(e){var t;if(!(t=m(this)).find(".muted").length&&!m(e.target).is(".btn.mute"))return C(t)},C=function(e){var t,n,i,a,o,r;if(e.length)return s=m("#lightbox-media"),e.find("object").length?(a=e.find("object")[0],n=m(a).clone()[0],s.append(n)):e.find("img").length?(o=e.find("img").attr("src"),s.css({backgroundImage:"url("+o+")"})):e.find("video").length?(r=e.find("video")[0],i=m(r).clone()[0],s.append(i),i.currentTime=r.currentTime,i.volume=.8,i.muted=!1,i.play()):e.css("background-image")&&(t=e.css("background-image"),s.css({backgroundImage:t})),c.addClass("open-lightbox no-scroll"),u()},n=function(e){var t;return s=m("#lightbox-media"),c.removeClass("open-lightbox no-scroll"),c.hasClass("open-archive")&&(t=window.location.href.split("#")[0],history.pushState(null,null,t+"#archive")),setTimeout(function(){return s.html("").attr("style","")},200),m(window).scroll()},function(){return m(".media-block video").each(function(e,t){return t.muted=!1,t.play()})},u=function(){return m(".media-block video").each(function(e,t){return t.volume=0})},B=function(){var e,t;return e=m(this).parents(".media"),t=m(e).find("video"),e.toggleClass("muted"),t.muted=e.is(".muted"),m(window).scroll()},_=function(e){return c.toggleClass("open-menu no-scroll")},D=function(e){var t,n;if(t=m(this).data("id"),(n=m('.media[data-id="'+t+'"]')).length)return m(".media").removeClass("show"),n.addClass("show")},e=function(e){return m(".media").removeClass("show")},L=function(e){var t,n;return n=m(this).data("id"),t=m('.tab-content[data-id="'+n+'"]'),m(".tab, .tab-content").removeClass("active"),m(this).addClass("active"),t.addClass("active")},W=function(e){var t,n,i;return n=m(this).parents(".expand-wrapper"),t=n.find(".expand-content"),n.toggleClass("open"),i=n.is(".open")?n.find(".expand-inner").innerHeight():0,t.animate({height:i},500,function(){if(n.is(".open"))return t.css({height:"auto"})})},h=function(e){if(i.length&&m(".blocks-inner").css({paddingBottom:i.innerHeight()+30}),m(".block-media.slideshow").each(function(e,t){var n,i;if(i=(t=m(t)).attr("data-ratio"))return n=t.innerWidth()*i,t.css({height:n+30+"px"})}),r.is(".masonry"))return r.masonry()},o=function(e){if("Escape"===e.key&&(c.is(".open-lightbox")&&n(),c.is(".open-archive")))return t()},T=0,f=function(e){var t,n,i,a,u,o,r,s,h,f;if(!c.is(".page")&&!c.is(".archive"))return f=m(window).innerHeight(),h=f/2,u=m(window).scrollTop(),f+u,T<u?"down":"up",a=v.position().top,t=v.data("url"),r=l.offset().top<=u+f,a<=u?c.addClass("in-chapter"):c.removeClass("in-chapter"),r?(c.addClass("show-archive"),m(".section-title").removeClass("active")):(c.removeClass("show-archive"),s=[],m(".block.section-title").each(function(e,t){var n;if(m(t).offset().top-d.innerHeight()-1<=u)return n=m(t).attr("id"),s.push(n)}),(n=s[s.length-1])?(i=S.find('[data-slug="'+n+'"]')).is(".active")||(i.addClass("active"),o=i.find("a").attr("href"),c.is(".open-archive")||c.is(".open-lightbox")||history.pushState(null,null,t+o)):window.location.hash.length&&(c.is(".open-archive")||c.is(".open-lightbox")||history.pushState(null,null,"#")),m(".section-title").not(i).removeClass("active")),m(".media-block video").each(function(e,t){var n,i,a,o,r,s,l,c,d;return n=m(t).parents(".media"),r=(o=m(t).innerHeight()/2)+(l=m(t).offset().top),i=m(t).innerHeight()+l,c=l-u,s=u-r+h,a=i-u,d=n.is(".muted")?0:0<=s?p(a,0,h+o):p(c,f,h-o),0<(t.volume=d)?m(t).addClass("play"):m(t).removeClass("play")}),T=u},a=function(){return m(".media-block video").each(function(e,t){return t.play()})},p=function(e,t,n){var i;return.8<(i=.8*(e-t)/(n-t)+0)&&(i=.8),i<0&&(i=0),i},z=function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},c.on("vclick",".archive-toggle",P),c.on("vclick",".menu-toggle",_),c.on("mouseenter",".chapter-square:not(.show)",D),c.on("mouseleave",".chapter-square",e),c.on("vclick",".tabs .tab:not(.active)",L),c.on("vclick",".expand-toggle",W),c.on("vclick",".section-anchor",q),c.on("click","a.chapter-square",j),c.on("click",".block-media",I),c.on("click",".mutable .btn",B),c.on("vclick",".lightbox-close, #lightbox-media",n),c.on("keyup",o),c.on("click",a),m(window).on("resize",h),m(window).on("load",function(){return k(),y(),x(),w()}),h()});